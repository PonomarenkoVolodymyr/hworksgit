"use strict";var API_KEY="a2ef5fc",el=function(n){return document.getElementById(n)},form=el("search-form");function searchMovie(t){var e,a,r,s,i=arguments;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return e=1<i.length&&void 0!==i[1]?i[1]:"",a=2<i.length&&void 0!==i[2]?i[2]:"",n.next=4,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&s=").concat(t,"&type=").concat(e,"&y=").concat(a)));case 4:return r=n.sent,n.next=7,regeneratorRuntime.awrap(r.json());case 7:if("False"===(s=n.sent).Response)return toast.error(s.Error),n.abrupt("return");n.next=11;break;case 11:showMovieList(s.Search);case 12:case"end":return n.stop()}})}function showMovieList(n){var e="";n.forEach(function(n,t){e+='\n        <div class="card" >\n            <img class="card-img-top" src="'.concat(n.Poster,'" alt="').concat(n.Title,' poster" onerror="this.src=\'./assets/img/no-img.png\'">\n            <div class="card-body">\n                <h5 class="card-title">').concat(n.Title,'</h5>\n                <p class="card-text">').concat(n.Year,'</p>\n                <button type="button" class="btn btn-primary btn-details" data-id="').concat(n.imdbID,'">Details</button>\n                <button type="button" id="favorite-btn" class="btn btn-secondary favorite-btn" data-id="').concat(n.imdbID,'" data-index="').concat(t,'" title="Add to favorite"><i class="fa-solid fa-heart favorite-icon"></i></button>\n            </div>\n        </div>\n        ')}),el("movies-list").innerHTML=e,document.querySelectorAll(".btn-details").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),detailInfo(t.dataset.id)})}),document.querySelectorAll(".favorite-btn").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),addRemoveFav(t.dataset.id)})})}function modalClose(){el("overlay").classList.remove("active"),el("modal-window").classList.remove("active")}function detailInfo(t){var e,a,r;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&i=").concat(t)));case 2:return e=n.sent,n.next=5,regeneratorRuntime.awrap(e.json());case 5:if("False"===(a=n.sent).Response)return toast.error(a.Error),n.abrupt("return");n.next=9;break;case 9:r='\n    <div class="modal-wrap">    \n            <div class="main-info">\n                <img src="'.concat(a.Poster,'" alt="').concat(a.Title,' poster" onerror="this.src=\'./assets/img/no-img.png\'">\n                <ul>\n                    <li>\n                        <h4>').concat(a.Title,"</h4>\n                    </li>\n                    <li>\n                        <p>Released: <span>").concat(a.Released,"</span></p>\n                    </li>\n                    <li>\n                        <p>Genre: <span>").concat(a.Genre,"</span></p>\n                    </li>\n                    <li>\n                        <p>Runtime: <span>").concat(a.Runtime,"</span></p>\n                    </li>\n                    <li>\n                        <p>Country: <span>").concat(a.Country,"</span></p>\n                    </li>\n                    <li>\n                        <p>IMDB Rating: <span>").concat(a.imdbRating,"</span></p>\n                    </li>\n                    <li>\n                        <p>Cast: <span>").concat(a.Actors,"</span></p>\n                    </li>\n                    <li>\n                        <p>Director: <span>").concat(a.Director,"</span></p>\n                    </li>\n                    <li>\n                        <p>Writer: <span>").concat(a.Writer,"</span></p>\n                    </li>\n                    <li>\n                        <p>Languages: <span>").concat(a.Language,"</span></p>\n                    </li>\n                    <li>\n                        <p>Awards: <span>").concat(a.Awards,'</span></p>\n                    </li>\n\n                </ul>\n            </div>\n            <div class="summary">\n                <p><span>Plot summary: </span>').concat(a.Plot,'</p>\n            </div>\n            <button type="button" onclick="modalClose()" class="btn btn-success">Close</button>\n        </div>\n        '),el("modal-window").innerHTML="",el("modal-window").insertAdjacentHTML("afterbegin",r),el("overlay").classList.add("active"),el("modal-window").classList.add("active");case 14:case"end":return n.stop()}})}function addRemoveFav(t){var n=JSON.parse(localStorage.getItem("favoriteList"));null===n&&(n=[]);var e=n.findIndex(function(n){return n.imdbID===t});-1===e?(n.push({id:t}),el("favorite-btn").classList.remove("btn-secondary"),el("favorite-btn").classList.add("btn-warning"),toast.success("Film added to Favorites")):(n.splice(e,1),el("favorite-btn").classList.remove("btn-warning"),el("favorite-btn").classList.add("btn-secondary"),toast.error("Film removed from Favorites")),localStorage.setItem("favoriteList",JSON.stringify(n))}form.addEventListener("submit",function(n){n.preventDefault();var t=el("search-input").value.trim(),e=el("type").value,a=el("year").value;if(""===t)return toast.info("Enter movie name for searching");searchMovie(t,e,a)}),el("year").setAttribute("max",(new Date).getFullYear());