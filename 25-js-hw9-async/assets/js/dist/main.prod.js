"use strict";var API_KEY="a2ef5fc";function successToast(){Toastify({text:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Movie added to favorites",duration:3500,newWindow:!0,gravity:"top",position:"left",close:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}function errorToast(){Toastify({text:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Movie deleted from favorites",duration:3500,newWindow:!0,gravity:"top",position:"left",close:!0,style:{background:"linear-gradient(to right, #ff5f6d, #ffc371)"}}).showToast()}function infoToast(){Toastify({text:0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Please enter the movie title",duration:3500,newWindow:!0,gravity:"top",position:"left",close:!0,style:{background:"linear-gradient(to right,rgb(44, 60, 240),rgb(53, 174, 249))"}}).showToast()}var el=function(t){return document.getElementById(t)},form=el("search-form");function searchMovie(e){var n,a,o,i,r=arguments;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return n=1<r.length&&void 0!==r[1]?r[1]:"",a=2<r.length&&void 0!==r[2]?r[2]:"",t.next=4,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&s=").concat(e,"&type=").concat(n,"&y=").concat(a)));case 4:return o=t.sent,t.next=7,regeneratorRuntime.awrap(o.json());case 7:if("False"===(i=t.sent).Response)return errorToast(i.Error),t.abrupt("return");t.next=11;break;case 11:showMovieList(i.Search);case 12:case"end":return t.stop()}})}function showMovieList(t){var i=JSON.parse(localStorage.getItem("favoriteList"))||[],r="";t.forEach(function(e,t){var n=i.some(function(t){return t.id===e.imdbID}),a=n?"btn-warning":"btn-secondary",o=n?"Remove from favorite":"Add to favorite";r+='\n        <div class="card" >\n            <img class="card-img-top" src="'.concat(e.Poster,'" alt="').concat(e.Title,' poster" onerror="this.src=\'./assets/img/no-img.png\'">\n            <div class="card-body">\n                <h5 class="card-title">').concat(e.Title,'</h5>\n                <p class="card-text">').concat(e.Year,'</p>\n                <button type="button" class="btn btn-primary btn-details" data-id="').concat(e.imdbID,'">Details</button>\n                <button type="button" class="btn ').concat(a,' favorite-btn" data-id="').concat(e.imdbID,'" data-title="').concat(e.Title,'" data-year="').concat(e.Year,'" data-poster="').concat(e.Poster,'" title="').concat(o,'">\n                <i class="fa-solid fa-heart favorite-icon"></i>\n                </button>\n            </div>\n        </div>\n        ')}),el("movies-list").innerHTML=r,document.querySelectorAll(".btn-details").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),detailInfo(e.dataset.id)})}),document.querySelectorAll(".favorite-btn").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),addRemoveFav({id:e.dataset.id,title:e.dataset.title,year:e.dataset.year,poster:e.dataset.poster},e)})})}function modalClose(){el("overlay").classList.remove("active"),el("modal-window").classList.remove("active")}function detailInfo(e){var n,a,o;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(fetch("https://www.omdbapi.com/?apikey=".concat(API_KEY,"&i=").concat(e)));case 2:return n=t.sent,t.next=5,regeneratorRuntime.awrap(n.json());case 5:if("False"===(a=t.sent).Response)return errorToast(a.Error),t.abrupt("return");t.next=9;break;case 9:o='\n    <div class="modal-wrap">    \n            <div class="main-info">\n                <img src="'.concat(a.Poster,'" alt="').concat(a.Title,' poster" onerror="this.src=\'./assets/img/no-img.png\'">\n                <ul>\n                    <li>\n                        <h4>').concat(a.Title,"</h4>\n                    </li>\n                    <li>\n                        <p>Released: <span>").concat(a.Released,"</span></p>\n                    </li>\n                    <li>\n                        <p>Genre: <span>").concat(a.Genre,"</span></p>\n                    </li>\n                    <li>\n                        <p>Runtime: <span>").concat(a.Runtime,"</span></p>\n                    </li>\n                    <li>\n                        <p>Country: <span>").concat(a.Country,"</span></p>\n                    </li>\n                    <li>\n                        <p>IMDB Rating: <span>").concat(a.imdbRating,"</span></p>\n                    </li>\n                    <li>\n                        <p>Cast: <span>").concat(a.Actors,"</span></p>\n                    </li>\n                    <li>\n                        <p>Director: <span>").concat(a.Director,"</span></p>\n                    </li>\n                    <li>\n                        <p>Writer: <span>").concat(a.Writer,"</span></p>\n                    </li>\n                    <li>\n                        <p>Languages: <span>").concat(a.Language,"</span></p>\n                    </li>\n                    <li>\n                        <p>Awards: <span>").concat(a.Awards,'</span></p>\n                    </li>\n\n                </ul>\n            </div>\n            <div class="summary">\n                <p><span>Plot summary: </span>').concat(a.Plot,'</p>\n            </div>\n            <button type="button" onclick="modalClose()" class="btn btn-success">Close</button>\n        </div>\n        '),el("modal-window").innerHTML="",el("modal-window").insertAdjacentHTML("afterbegin",o),el("overlay").classList.add("active"),el("modal-window").classList.add("active");case 14:case"end":return t.stop()}})}function addRemoveFav(e,t){var n=JSON.parse(localStorage.getItem("favoriteList"))||[],a=n.findIndex(function(t){return t.id===e.id});-1===a?(n.push(e),t.classList.remove("btn-secondary"),t.classList.add("btn-warning"),t.title="Remove from favorite",successToast('"'.concat(e.title,'" added to Favorites'))):(n.splice(a,1),t.classList.remove("btn-warning"),t.classList.add("btn-secondary"),t.title="Add to favorite",errorToast('"'.concat(e.title,'" removed from Favorites'))),localStorage.setItem("favoriteList",JSON.stringify(n))}form.addEventListener("submit",function(t){t.preventDefault();var e=el("search-input").value.trim(),n=el("type").value,a=el("year").value;if(""===e)return infoToast("Enter movie name for searching");searchMovie(e,n,a)}),el("year").setAttribute("max",(new Date).getFullYear());var favoriteMainBtn=document.getElementById("favorite");function showFavoritesModal(){var t=JSON.parse(localStorage.getItem("favoriteList"))||[];if(0===t.length){infoToast("No favorites yet!");var e='\n    <div class="modal-wrap">\n        <div class="favorite-wrap">\n            <div class="favorite-header">\n                <h3>Your Favorite Movies ('.concat(t.length,')</h3>\n                <button type="button" onclick="modalClose()" class="btn btn-success btn-fav">Close</button>\n            </div>                  \n            <h2>No favorites yet!</h2>                    \n        </div>\n    </div>\n    ');return el("modal-window").innerHTML=e,el("modal-window").classList.add("favorite-modal"),el("overlay").classList.add("active"),void el("modal-window").classList.add("active")}var n='\n    <div class="modal-wrap">\n    <div class="favorite-wrap">\n        <div class="favorite-header">\n            <h3>Your Favorite Movies ('.concat(t.length,')</h3>\n            <button type="button" onclick="modalClose()" class="btn btn-success btn-fav">Close</button>\n        </div>\n        <div class="favorites-list">\n    ');t.forEach(function(t){n+='\n        <div class="favorite-item">            \n            <img src="'.concat(t.poster,'" alt="').concat(t.title,'" onerror="this.src=\'./assets/img/no-img.png\'">            \n            <div class="favorite-info">\n                <h5>').concat(t.title,"</h5>\n                <p>").concat(t.year,'</p>\n            </div>\n            <button class="btn btn-danger btn-sm remove-fav" data-id="').concat(t.id,'">\n                <i class="fa-solid fa-trash"></i>\n            </button>\n        </div>\n        ')}),el("modal-window").innerHTML=n,el("modal-window").classList.add("favorite-modal"),el("overlay").classList.add("active"),el("modal-window").classList.add("active"),document.querySelectorAll(".remove-fav").forEach(function(e){e.addEventListener("click",function(t){removeFromFavorites(e.dataset.id)})})}function removeFromFavorites(e){var t,n=JSON.parse(localStorage.getItem("favoriteList"))||[],a=n.findIndex(function(t){return t.id===e});-1!==a&&(t=n[a].title,n.splice(a,1),localStorage.setItem("favoriteList",JSON.stringify(n)),errorToast('"'.concat(t,'" removed from Favorites')),showFavoritesModal())}favoriteMainBtn&&favoriteMainBtn.addEventListener("click",function(t){t.preventDefault(),showFavoritesModal()});